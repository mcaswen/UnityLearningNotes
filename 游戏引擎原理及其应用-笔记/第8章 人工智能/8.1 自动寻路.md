#### 游戏中的人工智能
- 为了提升玩家的用户体验
- 非玩家角色`NPC`应用较多
- 和玩家进行竞争或协作

#### 常见人工智能类型
- **有限状态机 Finite State Machine (`FSM`)**
	- 考虑智能体所有可能的行为
	- 行为之间可以进行有条件的转换，需编写代码实现转换逻辑
- **蒙特卡洛树搜索 Monte Carlo Search Tree (`MCST`)**
	- 将智能体对当前条件的**所有**可能的反应构造成树
	- 模拟各个行为序列的收益以及代价
		- 然后寻找最优策略来执行
		- 根据玩家反应进行循环更新

#### 游戏AI实践-寻路
- 让角色可以自动在游戏世界中找到通路
- 如果有楼梯、障碍或者沟渠也可以以不同方式通过
- 最常用的是`A*`算法
	- 从起始开始，遍历四周的点，寻找其中**最有可能成为最短路径**的点
	- 以这个点为基准，继续向四周遍历，直到终点
- 需解决两个问题：
	- **如何让智能体了解自己的移动范围**
	- **如何让智能体找到目标并移动到目标位置**


#### 寻路相关的概念
- **导航网格 `NavMesh`**
	- 描述场景中可通过区域的数据结构
	- 通过测试代理可站立的位置，从场景中的几何体自动构建出
	- 可以自动创建
- **`NavMesh Agent`**
	- 待控制角色，在移动时可以自动躲避障碍物
- **`Off-Mesh Link`**
	- 将两个不可直接通过区域连接起来
- **`NavMesh Obstacle`**
	- 可移动的障碍物，让agent能够在寻路时避开

#### Unity中的自动寻路实践
- 物体只有被设置为静态类型才能被自动寻路系统识别
- 在`Navigation`窗口中进行设置
	- **`Agent`**：被导航的对象，一般视为圆柱体
		- 可以设置区域遮蔽，使角色无法在特定区域中移动
	- **`Area`**：导航区域设置
		- 分为用户自定义区域类型和自带区域类型
		- 可以自由设置开销
	- **`Bake`**：为场景预计算出导航网格
		- `Agent Radius`
			- 对`Agent`的圆柱体半径进行设置，越大则可通行范围越小。
			- 取决于游戏中具体的Agent大小
		- `Max Slope`
			- 可通过的最大坡度
		- `Step Height`
			- 可通过的楼梯高度
	- **`Object`**：对选中的物体进行导向相关设置
- **代码示例**
```
using UnityEngine.AI

public class PlayerAI : MonoBehaviour
{
	public NavMeshAgent agent;
	
	void Start()
	{
		agent = GetComponent<NavMeshAgent>();
	}
	
	void Update()
	{
		if (Input.GetMouseButtonDown(0))
		{
			RayCastHit hit;
			if (Physics.RayCast(Camera.main.ScreenPointToRay(Input.mousePosition, out hit, 100)))
			{
				agent.destinaiton = hit.point;
			}
		}
	}
}
```
- 通过在`Off-Mesh Link`组件中设置**起始点**和**结束点**来实现两个可通行区域之间的跨越
- 给动态物体添加 `Nav Mesh Obstacle`组件来实现动态障碍物检测。