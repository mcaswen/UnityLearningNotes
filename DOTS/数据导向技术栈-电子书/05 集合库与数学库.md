# Collections（集合库）

**Collections 包**提供**非托管**集合类型（如列表、哈希映射），它们针对 **Jobs** 与 **Burst 编译代码**做了优化。

所谓**非托管**，就是这些集合**不受 C# 运行时与 GC 管理**；你需要在不再使用时**显式调用 `Dispose()`** 释放。因为是非托管，它们**不会产生 GC 压力**，并且**可以安全用于 Job 与 Burst 场景**。

集合类型大致分为几类：

- 名称以 **`Native`** 开头的类型：带**安全检查**。若集合**未正确释放**，或在 Job 中**以非线程安全**方式使用，会**抛错**。
    
- 名称以 **`Unsafe`** 开头的类型：**不做安全检查**（高风险）。
    
- 既不是 `Native` 也不是 `Unsafe` 的：通常是**不含指针的小型 struct**，**完全不分配内存**，因此**无需释放**，也**没有**潜在的线程安全问题。
    

很多 `Native` 类型都有对应的 `Unsafe` 版本（如 `NativeList`/`UnsafeList`、`NativeHashMap`/`UnsafeHashMap` 等）。**能用 `Native` 就用 `Native`**，除非你非常确定线程安全并且明确要绕开检查。

---

# Mathematics（数学库）

**Mathematics 包**是一套 C# 数学库，和 Collections 类似，是为 **Burst + Job System** 设计的：便于把 C#/IL 编译为**高效的原生代码**。它提供：

- **向量/矩阵类型**：如 `float3`、`quaternion`、`float3x3`；
    
- **大量数学方法与运算符**，遵循**类 HLSL** 的着色器约定；
    
- 针对多种方法与运算符的 **Burst 特殊优化钩子**；并提供官方 **cheat sheet** 速查。
    

补充：**大多数 `UnityEngine.Mathf`** 的类型/方法在 Burst 编译代码里**也是可用的**，但在某些场景，**`Unity.Mathematics` 等价实现更快**。